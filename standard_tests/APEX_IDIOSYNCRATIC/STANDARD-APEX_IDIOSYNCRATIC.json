[{"STANDARD_ID":335371825641905585121080132445374054310,"TEST_ID":337562663240681610623825573144563040217,"LEVEL_ID":319367883342218894314577550181439009696,"TEST_NAME":"SVT Application Pages should have Authorization Schemes","TEST_CODE":"AST_PAGE_AUTH","STANDARD_NAME":"APEX Idiosyncratic","ACTIVE_YN":"Y","NT_NAME":"V_SVT_APEX__0_NT","QUERY_CLOB":"with origin_auth as (select \r\n                         spu.destination_app_id, spu.destination_page_id\r\n                         , listagg(distinct spu.element_authorization       ,'/' on overflow truncate with count) within group (order by spu.element_authorization) origin_element_authorization\r\n                         , listagg(distinct spu.parent_element_authorization,'/' on overflow truncate with count) within group (order by spu.parent_element_authorization) origin_parent_element_authorization\r\n                         , listagg(distinct spu.page_authorization          ,'/' on overflow truncate with count) within group (order by spu.page_authorization) origin_page_authorization\r\n                         from v_mv_svt spu\r\n                         where spu.destination_app_id is not null\r\n                         and spu.destination_page_id is not null\r\n                         and spu.url_type not in ('BC_URL') --breadcrumbs cause a lot of complexity in this context\r\n                         group by spu.destination_app_id, spu.destination_page_id\r\n                    ),\r\n     a40 as (\r\n          select \r\n          case when aap.page_requires_authentication = 'Yes'\r\n               and aap.authorization_scheme is null\r\n               then 'N'\r\n\t\t\t \t\t\t\t when aap.authorization_scheme = 'APPLICATION SENTRY'\r\n\t\t\t \t\t\t\t then 'N'\r\n               else 'Y'\r\n               end as pass_yn, \r\n          aap.application_id,\r\n          aap.page_id, \r\n          aap.page_name, \r\n          aap.page_access_protection, \r\n          aap.page_mode,\r\n          aap.page_requires_authentication,\r\n          apex_string.format('%0:%1:%2:%3', oa.origin_element_authorization,oa.origin_parent_element_authorization, oa.origin_page_authorization, aa.authorization_scheme) origin_authorizations,\r\n          aap.build_option,\r\n          bo.build_option_status,\r\n\t\t\t    bo.status_on_export,\r\n          oa.origin_element_authorization,\r\n          oa.origin_parent_element_authorization origin_parent_elemnt_authztn, \r\n          oa.origin_page_authorization, \r\n          aa.authorization_scheme app_authorization_scheme,\r\n          aap.created_by, \r\n          aap.created_on, \r\n          aap.last_updated_by, \r\n          aap.last_updated_on,\r\n\t\t\t    aap.workspace\r\n          from apex_application_pages aap\r\n          inner join apex_applications aa on aap.application_id = aa.application_id\r\n                                          and aa.availability_status != 'Unavailable'\r\n          left join apex_application_build_options bo on aap.application_id = bo.application_id\r\n                                                  and aap.build_option = bo.build_option_name\r\n          left join origin_auth oa on oa.destination_app_id = aap.application_id\r\n                                   and oa.destination_page_id = aap.page_id\r\n          where aap.workspace = svt_preferences.get_preference ('SVT_DEFAULT_WORKSPACE')\r\n\t\t\t    and aap.page_id != 0\r\n          and (bo.status_on_export != 'Exclude' or bo.build_option_status is null)\r\n     )\r\nselect a40.pass_yn, \r\n       a40.application_id,\r\n       a40.page_id, \r\n       a40.page_name, \r\n       a40.page_access_protection, \r\n       a40.page_mode,\r\n       a40.page_requires_authentication,\r\n       a40.origin_authorizations,\r\n       a40.build_option,\r\n       a40.build_option_status,\r\n       a40.origin_element_authorization,\r\n       a40.origin_parent_elemnt_authztn, \r\n       a40.origin_page_authorization, \r\n       a40.app_authorization_scheme,\r\n       a40.created_by, \r\n       a40.created_on, \r\n       a40.last_updated_by, \r\n       a40.last_updated_on,\r\n       case when a40.pass_yn = 'N'\r\n            then apex_string.format(p_message => \r\n            q'^Page %10 is missing an authorization scheme. \r\n            • Page Access Protection: %0\r\n            • Page Mode: %1\r\n            • Page Requires Authentication: %2\r\n            • Origin Authorizations: %3 \r\n            %4 \r\n            %5^',\r\n            p0 => a40.page_access_protection, \r\n            p1 => a40.page_mode,\r\n            p2 => a40.page_requires_authentication,\r\n            p3 => a40.origin_authorizations,\r\n            p4 => case when a40.build_option is not null\r\n                       then '• Build Option: '||a40.build_option\r\n                       end,\r\n            p5 => case when a40.build_option_status is not null\r\n                       then '• Build status: '||a40.build_option_status\r\n                       end,\r\n            p6 => a40.origin_element_authorization,\r\n            p7 => a40.origin_parent_elemnt_authztn, \r\n            p8 => a40.origin_page_authorization, \r\n            p9 => a40.app_authorization_scheme,\r\n            p10 => a40.page_id\r\n            )\r\n            end as validation_failure_message,\r\n       case when a40.pass_yn = 'N'\r\n            then apex_string.format(p_message => \r\n            q'^Page %0 (app %1) is missing an authorization scheme^',\r\n            p0 => a40.page_id, \r\n            p1 => a40.application_id\r\n            )\r\n            end as issue_title,\r\n\t\t\t a40.page_id component_id,\r\n\t\t\t null parent_component_id,\r\n\t\t\t a40.workspace\r\nfrom a40\r\nwhere a40.application_id = 17000033","MV_DEPENDENCY":"V_MV_SVT","SVT_COMPONENT_TYPE_ID":4,"COMPONENT_NAME":"APEX_APPLICATION_PAGES","EXPLANATION":"SVT Application pages should have authorization schemes for consistency and security","FIX":"Select an authorization scheme applied to the page. Authorization schemes are defined at the application-level and can be applied to many elements within the application.\r\n\r\nAn authorization scheme is evaluated either once for each application session (at session creation), or once for each page view. If the selected authorization scheme evaluates to **TRUE**, then the page displays and is subject to other defined conditions. If it evaluates to **FALSE**, then the page does not display and an error message displays.","VERSION_NUMBER":1,"PUBLISHED_YN":"Y","WORKSPACE":"REDWOOD"},{"STANDARD_ID":335371825641905585121080132445374054310,"TEST_ID":2827393048770046455570700348523060042,"LEVEL_ID":319367883342220103240397164810613715872,"TEST_NAME":"blerg","TEST_CODE":"BLERG","STANDARD_NAME":"APEX Idiosyncratic","ACTIVE_YN":"Y","NT_NAME":"V_SVT_APEX__0_NT","QUERY_CLOB":"select case when 1=1\r\n            then 'N'\r\n            else 'Y'\r\n            end pass_yn,\r\n       aapb.workspace,\r\n       aapb.application_id, \r\n       aapb.page_id,\r\n       null created_by,\r\n       null created_on,\r\n       aapb.last_updated_by,\r\n       aapb.last_updated_on,\r\n       apex_string.format('Button `%0` (app %1, page %2) blerg', \r\n        p0 => aapb.button_name, \r\n        p1 => aapb.application_id,\r\n        p2 => aapb.page_id) validation_failure_message,\r\n       apex_string.format('Button `%0` (app %1, page %2) blerg', \r\n        p0 => aapb.button_name, \r\n        p1 => aapb.application_id,\r\n        p2 => aapb.page_id) issue_title,\r\n       aapb.button_id component_id,\r\n       null parent_component_id,\r\n       aapb.button_name,\r\n       aapb.button_template_options,\r\n       aapb.button_is_hot,\r\n       aapb.label,\r\n       aapb.database_action\r\nfrom apex_application_page_buttons aapb\r\ninner join apex_application_pages aap on aap.page_id = aapb.page_id\r\n                                      and aap.application_id = aapb.application_id\r\nleft outer join apex_application_build_options aabo1 on  aabo1.build_option_name = aap.build_option\r\n                                                     and aabo1.application_id = aap.application_id\r\nleft outer join apex_application_build_options aabo2 on  aabo2.build_option_name = aapb.build_option\r\n                                                     and aabo2.application_id = aapb.application_id\r\nwhere aapb.workspace = svt_preferences.get_preference ('SVT_DEFAULT_WORKSPACE')\r\nand coalesce(aabo1.status_on_export,'NA') != 'Exclude'\r\nand coalesce(aabo2.status_on_export,'NA') != 'Exclude'\r\nand aapb.application_id = 17000033","MV_DEPENDENCY":null,"SVT_COMPONENT_TYPE_ID":8,"COMPONENT_NAME":"APEX_APPLICATION_PAGE_BUTTONS","EXPLANATION":null,"FIX":null,"VERSION_NUMBER":1,"PUBLISHED_YN":"Y","WORKSPACE":"REDWOOD"}]    
