{"std_test":{"standard":{"standard_id":297008886111499643989624756707235911314,"standard_name":"Security","description":"These standards enforce security","compatibility_mode_id":1,"created":"2023-04-12T06:40:01.630000Z","created_by":"AST","updated":"2023-04-12T06:40:01.630000Z","updated_by":"AST"}},"test":[{"test_id":290954809810138535748024902016765152078,"test_name":"Application has Authorization Scheme","standard_id":297008886111499643989624756707235911314,"display_sequence":null,"query_clob":"select a1.pass_yn, \r\n       a1.application_id,  \r\n\t\t\t null child_code,\r\n       a1.authorization_scheme,\r\n\t\t\t null page_id,\r\n       a1.created_by, \r\n       a1.created_on, \r\n       a1.last_updated_by, \r\n       a1.last_updated_on,\r\n       case when a1.pass_yn = 'N'\r\n            then issue_desc\r\n            end as validation_failure_message,\r\n       case when a1.pass_yn = 'N'\r\n            then issue_desc\r\n            end as issue_title,\r\n\t\t\t a1.application_id component_id,\r\n       null parent_component_id,\r\n\t\t\t a1.workspace\r\nfrom (\r\n    select \r\n    case when aa.authorization_scheme is null\r\n        then 'N'\r\n        else 'Y'\r\n        end as pass_yn,\r\n    aa.application_id,\r\n    aa.authorization_scheme,\r\n    aa.created_by, \r\n    aa.created_on, \r\n    aa.last_updated_by, \r\n    aa.last_updated_on,\r\n    apex_string.format( p_message => q'^Application %0 is missing an Authorization scheme^',\r\n                        p0        => aa.application_id\r\n    ) issue_desc,\r\n\t  aa.workspace\r\n    from v_svt_apex_applications aa\r\n    where aa.availability_status != 'Unavailable'\r\n) a1","test_code":"APP_AUTH","level_id":319367883342220103240397164810613715872,"mv_dependency":null,"svt_component_type_id":1,"explanation":"\\[Applications have authorization schemes\\]  \r\nApplications should have application-level authorization schemes as a matter of best-practice","fix":"Specify an authorization scheme for your application. Application authorization schemes are defined for an application for the purpose of controlling access. Setting a required authorization scheme here at the application level will require all pages of the application to pass the defined authorization check.","version_number":1,"version_db":"ILA"},{"test_id":290954809810139744673844516645939858254,"test_name":"Application Pages should have Authorization Schemes","standard_id":297008886111499643989624756707235911314,"display_sequence":null,"query_clob":"with origin_auth as (select \r\n                         spu.destination_app_id, spu.destination_page_id\r\n                         , listagg(distinct spu.element_authorization       ,'/' on overflow truncate with count) within group (order by spu.element_authorization) origin_element_authorization\r\n                         , listagg(distinct spu.parent_element_authorization,'/' on overflow truncate with count) within group (order by spu.parent_element_authorization) origin_parent_element_authorization\r\n                         , listagg(distinct spu.page_authorization          ,'/' on overflow truncate with count) within group (order by spu.page_authorization) origin_page_authorization\r\n                         from v_mv_svt spu\r\n                         where spu.destination_app_id is not null\r\n                         and spu.destination_page_id is not null\r\n                         and spu.url_type not in ('BC_URL') --breadcrumbs cause a lot of complexity in this context\r\n                         group by spu.destination_app_id, spu.destination_page_id\r\n                    ),\r\n     a40 as (\r\n          select \r\n          case when aap.page_requires_authentication = 'Yes'\r\n               and aap.authorization_scheme is null\r\n               then 'N'\r\n               else 'Y'\r\n               end as pass_yn, \r\n          aap.application_id,\r\n          aap.page_id, \r\n          aap.page_name, \r\n          aap.page_access_protection, \r\n          aap.page_mode,\r\n          aap.page_requires_authentication,\r\n          apex_string.format('%0:%1:%2:%3', oa.origin_element_authorization,oa.origin_parent_element_authorization, oa.origin_page_authorization, aa.authorization_scheme) origin_authorizations,\r\n          aap.build_option,\r\n          bo.build_option_status,\r\n\t\t\t    bo.status_on_export,\r\n          oa.origin_element_authorization,\r\n          oa.origin_parent_element_authorization origin_parent_elemnt_authztn, \r\n          oa.origin_page_authorization, \r\n          aa.authorization_scheme app_authorization_scheme,\r\n          aap.created_by, \r\n          aap.created_on, \r\n          aap.last_updated_by, \r\n          aap.last_updated_on,\r\n\t\t\t    aap.workspace\r\n          from apex_application_pages aap\r\n          inner join v_svt_apex_applications aa on aap.application_id = aa.application_id\r\n                                        and aa.availability_status != 'Unavailable'\r\n          left join apex_application_build_options bo on aap.application_id = bo.application_id\r\n                                                  and aap.build_option = bo.build_option_name\r\n          left join origin_auth oa on oa.destination_app_id = aap.application_id\r\n                                   and oa.destination_page_id = aap.page_id\r\n          where aap.page_id != 0\r\n          and (bo.status_on_export != 'Exclude' or bo.build_option_status is null)\r\n     )\r\nselect a40.pass_yn, \r\n       a40.application_id,\r\n\t\t\t null child_code,\r\n       a40.page_id, \r\n       a40.page_name, \r\n       a40.page_access_protection, \r\n       a40.page_mode,\r\n       a40.page_requires_authentication,\r\n       a40.origin_authorizations,\r\n       a40.build_option,\r\n       a40.build_option_status,\r\n       a40.origin_element_authorization,\r\n       a40.origin_parent_elemnt_authztn, \r\n       a40.origin_page_authorization, \r\n       a40.app_authorization_scheme,\r\n       a40.created_by, \r\n       a40.created_on, \r\n       a40.last_updated_by, \r\n       a40.last_updated_on,\r\n       case when a40.pass_yn = 'N'\r\n            then apex_string.format(p_message => \r\n            q'^Page %10 is missing an authorization scheme. \r\n            • Page Access Protection: %0\r\n            • Page Mode: %1\r\n            • Page Requires Authentication: %2\r\n            • Origin Authorizations: %3 \r\n            %4 \r\n            %5^',\r\n            p0 => a40.page_access_protection, \r\n            p1 => a40.page_mode,\r\n            p2 => a40.page_requires_authentication,\r\n            p3 => a40.origin_authorizations,\r\n            p4 => case when a40.build_option is not null\r\n                       then '• Build Option: '||a40.build_option\r\n                       end,\r\n            p5 => case when a40.build_option_status is not null\r\n                       then '• Build status: '||a40.build_option_status\r\n                       end,\r\n            p6 => a40.origin_element_authorization,\r\n            p7 => a40.origin_parent_elemnt_authztn, \r\n            p8 => a40.origin_page_authorization, \r\n            p9 => a40.app_authorization_scheme,\r\n            p10 => a40.page_id\r\n            )\r\n            end as validation_failure_message,\r\n       case when a40.pass_yn = 'N'\r\n            then apex_string.format(p_message => \r\n            q'^Page %0 (app %1) is missing an authorization scheme^',\r\n            p0 => a40.page_id, \r\n            p1 => a40.application_id\r\n            )\r\n            end as issue_title,\r\n\t\t\t a40.page_id component_id,\r\n\t\t\t null parent_component_id,\r\n\t\t\t a40.workspace\r\nfrom a40","test_code":"PAGE_AUTH","level_id":319367883342218894314577550181439009696,"mv_dependency":"V_MV_SVT","svt_component_type_id":4,"explanation":"APEX pages should have authorization : Application pages should have authorization schemes","fix":"Select an authorization scheme applied to the page. Authorization schemes are defined at the application-level and can be applied to many elements within the application.\r\n\r\nAn authorization scheme is evaluated either once for each application session (at session creation), or once for each page view. If the selected authorization scheme evaluates to **TRUE**, then the page displays and is subject to other defined conditions. If it evaluates to **FALSE**, then the page does not display and an error message displays.","version_number":1,"version_db":"ILA"},{"test_id":1886968699064980647632422982138462475,"test_name":"HTML should be escaped in IR Columns","standard_id":297008886111499643989624756707235911314,"display_sequence":null,"query_clob":"select a20.pass_yn, \r\n       a20.application_id,\r\n       a20.page_id,\r\n       a20.region_id, \r\n       a20.region_name,\r\n       a20.report_type,\r\n       a20.column_alias,\r\n       a20.report_label,\r\n       a20.created_by, \r\n       a20.created_on, \r\n       a20.updated_by last_updated_by, \r\n       a20.updated_on last_updated_on,\r\n       case when a20.pass_yn = 'N'\r\n            then apex_string.format(p_message => q'^Region `%1` is escaping HTML for column `%3`/`%4` (Region id : %0, type : %2).^',\r\n                                    p0 => a20.region_id, \r\n                                    p1 => a20.region_name,\r\n                                    p2 => a20.report_type,\r\n                                    p3 => a20.column_alias,\r\n                                    p4 => a20.report_label\r\n                                    )\r\n            end as validation_failure_message,\r\n       case when a20.pass_yn = 'N'\r\n            then apex_string.format(p_message => q'^Region `%1` (app %0, page %2) is escaping HTML for column `%4`^',\r\n                                    p0 => a20.application_id, \r\n                                    p1 => a20.region_name,\r\n                                    p2 => a20.page_id,\r\n                                    p3 => a20.column_alias,\r\n                                    p4 => a20.report_label\r\n                                    )\r\n            end as issue_title,\r\n       a20.component_id,\r\n       null parent_component_id,\r\n\t\t\t a20.workspace\r\nfrom (\r\n     select \r\n     case when ic1.display_text_as = 'WITHOUT_MODIFICATION'\r\n          then case when ic1.format_mask like 'PCT_GRAPH%' --the percent graph column type does not escape apparently\r\n                    then 'Y'\r\n                    else 'N'\r\n                    end\r\n          else 'Y'\r\n          end as pass_yn,\r\n     ic1.application_id,\r\n     ic1.region_id, \r\n     ic1.page_id,\r\n     ic1.region_name, \r\n     'IR' report_type,\r\n     ic1.column_alias,\r\n     ic1.report_label,\r\n     coalesce(ic1.created_by, app.created_by) created_by, \r\n     coalesce(ic1.created_on, app.created_on) created_on, \r\n     coalesce(ic1.updated_by, app.last_updated_by) updated_by, \r\n     coalesce(ic1.updated_on, app.last_updated_on) updated_on,\r\n     ic1.column_id component_id,\r\n\t   ic1.workspace\r\n     from apex_application_page_ir_col ic1\r\n     inner join apex_application_pages app on  app.page_id = ic1.page_id\r\n                                           and app.application_id = ic1.application_id\r\n     inner join v_svt_apex_applications aa on ic1.application_id = aa.application_id\r\n                                       and aa.availability_status != 'Unavailable'\r\n\t   where ic1.workspace = svt_preferences.get('SVT_WORKSPACE')\r\n) a20","test_code":"IR_HTML_ESCAPING_COLS","level_id":299712008894515240349432973583165583501,"mv_dependency":null,"svt_component_type_id":6,"explanation":"IR Report columns should escape HTML : Avoid turning the \"Escape special characters\" setting off on report columns","fix":"To prevent Cross-Site Scripting (XSS) attacks, always set this attribute to **On**. If you need to render HTML tags stored in the page item or in the entries of a list of values, you can set this flag to **Off**. In such cases, you should take additional precautions to ensure any user input to such fields are properly escaped when entered and before saving.","version_number":1,"version_db":"ILA"},{"test_id":1886968699066189573452037611313168651,"test_name":"HTML should be escaped in IG Columns","standard_id":297008886111499643989624756707235911314,"display_sequence":null,"query_clob":"select a20.pass_yn, \r\n       a20.application_id,\r\n       a20.page_id,\r\n       a20.region_id, \r\n       a20.region_name,\r\n       a20.report_type,\r\n       a20.column_alias,\r\n       a20.report_label,\r\n       a20.created_by, \r\n       a20.created_on, \r\n       a20.last_updated_by, \r\n       a20.last_updated_on,\r\n       case when a20.pass_yn = 'N'\r\n            then apex_string.format(p_message => q'^Region `%1` is escaping HTML for column `%3`/`%4` (Region id : %0, type : %2).^',\r\n                                    p0 => a20.region_id, \r\n                                    p1 => a20.region_name,\r\n                                    p2 => a20.report_type,\r\n                                    p3 => a20.column_alias,\r\n                                    p4 => a20.report_label\r\n                                    )\r\n            end as validation_failure_message,\r\n       case when a20.pass_yn = 'N'\r\n            then apex_string.format(p_message => q'^Region `%1` (app %0, page %2) is escaping HTML for column `%4`^',\r\n                                    p0 => a20.application_id, \r\n                                    p1 => a20.region_name,\r\n                                    p2 => a20.page_id,\r\n                                    p3 => a20.column_alias,\r\n                                    p4 => a20.report_label\r\n                                    )\r\n            end as issue_title,\r\n       a20.component_id,\r\n       null parent_component_id,\r\n\t\t\t a20.workspace\r\nfrom (\r\n     select \r\n     case when ic2.escape_on_http_output ='Yes'\r\n          then 'Y'\r\n          when ic2.escape_on_http_output is null\r\n          then 'Y'\r\n          else 'N'\r\n          end as pass_yn, \r\n     ic2.application_id, \r\n     ic2.region_id, \r\n     ic2.page_id,\r\n     ic2.region_name, \r\n     'IR' report_type,\r\n     ic2.name column_alias,\r\n     ic2.heading report_label,\r\n     app.created_by, \r\n     app.created_on, \r\n     coalesce(ic2.last_updated_by, app.last_updated_by) last_updated_by, \r\n     coalesce(ic2.last_updated_on, app.last_updated_on) last_updated_on,\r\n     ic2.column_id component_id,\r\n\t   ic2.workspace\r\n     from apex_appl_page_ig_columns ic2\r\n     inner join apex_application_pages app on  app.page_id = ic2.page_id\r\n                                           and app.application_id = ic2.application_id\r\n     inner join v_svt_apex_applications aa on ic2.application_id = aa.application_id\r\n                                       and aa.availability_status != 'Unavailable'\r\n\t   where ic2.workspace = svt_preferences.get('SVT_WORKSPACE')\r\n) a20","test_code":"IG_HTML_ESCAPING_COLS","level_id":319367883342220103240397164810613715872,"mv_dependency":null,"svt_component_type_id":22,"explanation":"IG Report columns should escape HTML : Avoid turning the \"Escape special characters\" setting off on report columns","fix":"To prevent Cross-Site Scripting (XSS) attacks, always set this attribute to **On**. If you need to render HTML tags stored in the page item or in the entries of a list of values, you can set this flag to **Off**. In such cases, you should take additional precautions to ensure any user input to such fields are properly escaped when entered and before saving.","version_number":1,"version_db":"ILA"}]}    
